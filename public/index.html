<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Home</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
    />
    <link rel="stylesheet" href="css/index.css" />
  </head>

  <body>
    <header>
      <div class="logo">
        <div class="logo-wrap">
          <img src="images/cart.png" alt="Shopping cart logo" id="cart" />
          <img src="images/glass.png" alt="Search icon" id="glass" />
        </div>
        <span id="logo-text">ClassCart</span>
      </div>
    </header>

    <!-- SIDE BAR------------------------------------------------------------------------------------------------------------------------------------------------------------------------->
    <div id="sidebarOverlay" class="sidebar-overlay hidden"></div>

    <div id="sidebar" class="sidebar hidden">
      <button id="closeSidebar" class="close-btn">&times;</button>

      <h1 class="categories-title">Categories</h1>
      <br /><br />
      <ul class="sidebar-links">
        <li>
          <a href="#" onclick="filterItems('books')"
            ><i class="fas fa-book"></i> Books</a
          >
        </li>
        <li>
          <a href="#" onclick="filterItems('art-craft')"
            ><i class="fas fa-paint-brush"></i> Art & Craft Supplies</a
          >
        </li>
        <li>
          <a href="#" onclick="filterItems('clothing')"
            ><i class="fas fa-tshirt"></i> Clothing & Uniforms</a
          >
        </li>
        <li>
          <a href="#" onclick="filterItems('bags')"
            ><i class="fas fa-shopping-bag"></i> Bags & Storage</a
          >
        </li>
        <li>
          <a href="#" onclick="filterItems('tools')"
            ><i class="fas fa-tools"></i> Tools</a
          >
        </li>
        <li>
          <a href="#" onclick="filterItems('electronics')"
            ><i class="fas fa-tv"></i> Electronics</a
          >
        </li>
        <li>
          <a href="#" onclick="filterItems('essentials')"
            ><i class="fas fa-box"></i> Essentials</a
          >
        </li>
      </ul>
    </div>

    <div class="navBar">
      <button class="sideBarBtn" onclick="openSidebar()">☰</button>

      <nav
        class="navLinks"
        style="
          display: flex;
          align-items: center;
          gap: 20px;
          padding: 10px;
          flex-wrap: wrap;
        "
      ><a href="add-item.html">
  <button class="createNewListingBtn">Create New Listing + </button>
</a>
        <div class="searchBar" style="display: flex; align-items: center">
          <input
            type="text"
            placeholder="Search items..."
            style="
              padding: 10px 15px;
              border: 1px solid #ccc;
              border-radius: 25px;
              outline: none;
              width: 400px;
            "
          />
        </div>

        <div
          class="user-dropdown"
          style="position: relative; display: inline-block"
        >
          <div
            style="
              display: flex;
              align-items: center;
              gap: 8px;            "
          >
            <div class="loginbtn">
              <a href="login-register.html">Sign in / Log in</a>
            </div>

            <img
              src="images/userPic.jpg"
              alt="User profile picture"
              class="userPic"
              style="width: 40px; height: 40px; border-radius: 50%"
            />
          </div>

          <div class="user-dropdown-content">
            <a href="profile.html">My Account</a>
            <a href="#">Settings</a>
            <a href="#" id="logoutLink">Logout</a>
          </div>
        </div>
      </nav>
    </div>

    <main>
      <div class="overlay">
        <div class="content">
          <h2>BUY AND SELL MMCM</h2>
          <p>Find everything you need — all in one campus marketplace!</p>

          <div class="cards-horizontal">
            <div class="card">
              <img
                src="images/usb.jpg"
                alt="Art and craft supplies category image"
              />
              <h3>Art & Craft Supplies</h3>
            </div>
            <div class="card">
              <img
                src="images/usb.jpg"
                alt="Uniforms and clothing category image"
              />
              <h3>Uniforms & Clothing</h3>
            </div>
            <div class="card">
              <img
                src="images/usb.jpg"
                alt="Books and electronics category image"
              />
              <h3>Books & Electronics</h3>
            </div>
            <div class="card">
              <img src="images/usb.jpg" alt="Bags and storage category image" />
              <h3>Bags & Storage</h3>
            </div>
            <div class="card">
              <img
                src="images/usb.jpg"
                alt="Essentials and tools category image"
              />
              <h3>Essentials & Tools</h3>
            </div>
          </div>
        </div>
      </div>

       <h1>Available Listings</h1>
  <div id="itemsContainer" class="listings-container"></div>

    </main>

    <section class="new-items">
      <h2>Newly Listed Items</h2>
      <div class="items-container"></div>

      <div id="new-listed-items"></div>

    </section>

    <footer class="footer">
      <div class="footerlogo">ClassCart</div>
      <p>© 2025 ClassCart. All rights reserved.</p>
      <div class="footerlinks">
        <a href="#about">About</a>
        <a href="#faqs">FAQs</a>
        <a href="#contact">Contact Us</a>
        <a href="#">Terms of Service</a>
        <a href="#">Privacy Policy</a>
      </div>
      <div class="footersocials">
        <a href="#"><i class="fab fa-facebook-f"></i></a>
        <a href="#"><i class="fab fa-twitter"></i></a>
        <a href="#"><i class="fab fa-instagram"></i></a>
        <a href="#"><i class="fab fa-linkedin-in"></i></a>
      </div>
    </footer>

    <script src="js/index.js"></script>
    <script src="js/item-listings.js"></script>
<script>
document.addEventListener("DOMContentLoaded", async () => {
  const container = document.querySelector(".listed-items-container") || document.querySelector(".listed-items");

  if (!container) return;

  try {
    const response = await fetch("/api/listings");
    const listings = await response.json();

    container.innerHTML = "";
    listings.forEach((item) => {
      const card = document.createElement("div");
      card.classList.add("item-card");
      card.innerHTML = `
        <div class="card shadow-md p-3 m-2 rounded-xl" style="width:200px;">
          <img src="${item.imageUrl}" alt="${item.title}" class="w-full rounded-lg mb-2" style="height:150px; object-fit:cover;" />
          <p><strong>${item.title}</strong></p>
          <p>₱${item.price}</p>
          <p>${item.category}</p>
          <p>${item.condition}</p>
          <p>${item.location}</p>
          <p><i>Seller:</i> ${item.sellerName}</p>
        </div>
      `;
      container.appendChild(card);
    });
  } catch (err) {
    console.error("Failed to load listings:", err);
  }

  // auto-refresh once after adding item
  if (localStorage.getItem("reloadListings") === "true") {
    localStorage.removeItem("reloadListings");
    location.reload();
  }
});
</script>
<!-- SCRIPTS -->
<script src="js/index.js"></script>
<script src="js/item-listings.js"></script>

  </body>
</html>


